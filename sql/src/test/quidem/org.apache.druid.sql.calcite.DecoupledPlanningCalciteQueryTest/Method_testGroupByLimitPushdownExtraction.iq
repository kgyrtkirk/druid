# Method_testGroupByLimitPushdownExtraction case-crc:55fd31da
!set sqlQueryId dummy
!set sqlCurrentTimestamp 2000-01-01T00:00:00Z
!set defaultTimeout 300000
!set maxScatterGatherBytes 9223372036854775807
!set plannerStrategy DECOUPLED
!set debug true
!set outputformat mysql
!use druidtest:///
SELECT dim4, substring(dim5, 1, 1), count(*) FROM druid.numfoo WHERE dim4 = 'a' GROUP BY 1,2 LIMIT 2;
+------+--------+--------+
| dim4 | EXPR$1 | EXPR$2 |
+------+--------+--------+
| a    | a      |      2 |
| a    | b      |      1 |
+------+--------+--------+
(2 rows)

!ok
{
  "queryType" : "topN",
  "dataSource" : {
    "type" : "table",
    "name" : "numfoo"
  },
  "dimension" : {
    "type" : "extraction",
    "dimension" : "dim5",
    "outputName" : "_d0",
    "outputType" : "STRING",
    "extractionFn" : {
      "type" : "substring",
      "index" : 0,
      "length" : 1
    }
  },
  "metric" : {
    "type" : "dimension",
    "ordering" : {
      "type" : "lexicographic"
    }
  },
  "threshold" : 2,
  "intervals" : {
    "type" : "intervals",
    "intervals" : [ "-146136543-09-08T08:23:32.096Z/146140482-04-24T15:36:27.903Z" ]
  },
  "filter" : {
    "type" : "equals",
    "column" : "dim4",
    "matchValueType" : "STRING",
    "matchValue" : "a"
  },
  "granularity" : {
    "type" : "all"
  },
  "aggregations" : [ {
    "type" : "count",
    "name" : "a0"
  } ],
  "postAggregations" : [ {
    "type" : "expression",
    "name" : "s0",
    "expression" : "'a'",
    "outputType" : "STRING"
  } ]
}
!nativePlan

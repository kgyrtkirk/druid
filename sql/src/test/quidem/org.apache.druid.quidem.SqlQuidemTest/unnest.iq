!set plannerStrategy DECOUPLED
!use druidtest://?numMergeBuffers=3
!set outputformat mysql

SELECT longs FROM druid.arrays, UNNEST(arrayLongNulls) as u(longs);
LogicalProject(longs=[$12])
  LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{4}])
    LogicalTableScan(table=[[druid, arrays]])
    LogicalProject(longs=[$0])
      Uncollect
        LogicalProject(arrayLongNulls=[$cor0.arrayLongNulls])
          LogicalValues(tuples=[[{ 0 }]])

!convertedPlan
LogicalProject(longs=[$12])
  LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{4}])
    LogicalTableScan(table=[[druid, arrays]])
    Uncollect
      LogicalProject(arrayLongNulls=[$cor0.arrayLongNulls])
        LogicalValues(tuples=[[{ 0 }]])

!logicalPlan
DruidProject(longs=[$12], druid=[logical])
  DruidLogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{4}])
    DruidTableScan(table=[[druid, arrays]], druid=[logical])
    DruidUncollect
      DruidProject(arrayLongNulls=[$cor0.arrayLongNulls], druid=[logical])
        DruidValues(tuples=[[{ 0 }]])

!druidPlan
!nativePlan


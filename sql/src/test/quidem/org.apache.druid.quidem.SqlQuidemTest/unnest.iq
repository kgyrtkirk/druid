!set plannerStrategy DECOUPLED
!use druidtest://?numMergeBuffers=3
!set outputformat mysql

SELECT longs FROM druid.arrays, UNNEST(arrayLongNulls) as u(longs);
LogicalProject(longs=[$12])
  LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{4}])
    LogicalTableScan(table=[[druid, arrays]])
    LogicalProject(longs=[$0])
      Uncollect
        LogicalProject(arrayLongNulls=[$cor0.arrayLongNulls])
          LogicalValues(tuples=[[{ 0 }]])

!convertedPlan
LogicalProject(longs=[$12])
  LogicalUnnest
    LogicalTableScan(table=[[druid, arrays]])

!logicalPlan

!here
DruidProject(longs=[$12], druid=[logical])
  DruidUnnest
    DruidTableScan(table=[[druid, arrays]], druid=[logical])

!finalExecutionPlan

!nativePlan


LogicalPlan plan = calcite.plan();
PhysicalQuery pq = DruidQueryGenerator.generate(plan);


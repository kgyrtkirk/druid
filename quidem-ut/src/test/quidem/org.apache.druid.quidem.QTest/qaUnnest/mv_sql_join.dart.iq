!set dartQueryId 00000000-0000-0000-0000-000000000000
!set sqlJoinAlgorithm sortMerge
!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=DartComponentSupplier&datasets=sql/src/test/quidem/qatests/qaUnnest/mv
!set outputformat mysql
SELECT *
FROM test_unnest;
+-------------------------+-------+--------+---------+----------+------------------------------------------------+------------------------+--------------------------------------+----------------------------------+--------------------------------------+----------------------------------+-----------------------------+
| __time                  | c_str | c_long | c_float | c_double | c_mv_complex                                   | c_mv_num               | c_mv_complex_with_null_and_empty_val | c_mv_num_with_null_and_empty_val | c_mv_complex_with_null_and_empty_row | c_mv_num_with_null_and_empty_row | c_mv_all_null_and_empty_val |
+-------------------------+-------+--------+---------+----------+------------------------------------------------+------------------------+--------------------------------------+----------------------------------+--------------------------------------+----------------------------------+-----------------------------+
| 2022-01-01 00:00:00.000 |       |      1 |     0.1 |      0.1 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            |                                      |                                  | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 | str2  |      2 |     0.2 |      0.2 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 | str3  |      3 |     0.3 |      0.3 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 | str4  |      4 |     0.4 |      0.4 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            | [null,"",null,"",null]      |
| 2022-01-01 00:00:00.000 |       |      0 |     0.0 |      0.0 | ["my_null","my_empty","1","[2]","[3, [4, 5]]"] | ["-1","0","1","2","3"] | [null,"","1","[2]","[3, [4, 5]]"]    | [null,"","1","2","3"]            |                                      |                                  | [null,"",null,"",null]      |
+-------------------------+-------+--------+---------+----------+------------------------------------------------+------------------------+--------------------------------------+----------------------------------+--------------------------------------+----------------------------------+-----------------------------+
(5 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest t2 ON u.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
INNER JOIN test_unnest t2,
           unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t2.c_long AS char)=u.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
INNER JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
INNER JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
INNER JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
INNER JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
INNER JOIN t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
INNER JOIN t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B12 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B13 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B14 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B15 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B16 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B17 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B18 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B19 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
INNER JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN t1 t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN t1 t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN t1 t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A1_B31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
INNER JOIN t1 t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest t2 ON u.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
JOIN test_unnest t2,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t2.c_long AS char)=u.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
JOIN t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
JOIN t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B12 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest t2,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B13 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest t2,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B14 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest t2,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B15 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest t2,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B16 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B17 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B18 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B19 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
JOIN test_unnest,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN t1 t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN t1 t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN t1 t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A2_B31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
JOIN t1 t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest t2 ON u.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
LEFT JOIN test_unnest t2,
          unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t2.c_long AS char)=u.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
LEFT JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
LEFT JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
LEFT JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
LEFT JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
LEFT JOIN t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
LEFT JOIN t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B12 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B13 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B14 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B15 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B16 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B17 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B18 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B19 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
LEFT JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN t1 t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN t1 t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN t1 t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A3_B31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
LEFT JOIN t1 t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest t2 ON u.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
RIGHT JOIN test_unnest t2,
           unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t2.c_long AS char)=u.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
RIGHT JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
RIGHT JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
RIGHT JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
RIGHT JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
RIGHT JOIN t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
RIGHT JOIN t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B12 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B13 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B14 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B15 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest t2,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B16 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B17 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B18 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B19 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
RIGHT JOIN test_unnest,
           unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN t1 t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN t1 t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN t1 t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A4_B31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
RIGHT JOIN t1 t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest t2 ON u.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B3 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
FULL JOIN test_unnest t2,
          unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t2.c_long AS char)=u.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
FULL JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
FULL JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
FULL JOIN test_unnest t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
FULL JOIN test_unnest t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
FULL JOIN t2 ON t2.c_long=t1.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
FULL JOIN t2 ON t2.c=cast(t1.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B12 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B13 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B14 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B15 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest t2,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B16 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B17 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B18 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON cast(t1.c_long AS char)=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B19 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
FULL JOIN test_unnest,
          unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) t2 AS u(c) ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c_long=t2.c_long
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c=cast(t2.c_long AS char)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c_long=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A5_B31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
FULL JOIN t1 t2 ON t1.c=t2.c
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)
CROSS JOIN test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN test_unnest t2,
           unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u(c)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B3 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
CROSS JOIN test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1
CROSS JOIN test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1
CROSS JOIN t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(45 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1
CROSS JOIN unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1)
CROSS JOIN test_unnest t2
CROSS JOIN unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+----+
| c_str | c_long | c1 |
+-------+--------+----+
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 1  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 2  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 | 3  |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
|       |      1 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 1  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 2  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 | 3  |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
| str2  |      2 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 1  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 2  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 | 3  |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
|       |      0 |    |
+-------+--------+----+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1
CROSS JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
CROSS JOIN
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A6_B10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1
CROSS JOIN t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(225 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B1 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t2.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c),
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c),
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND u.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B4 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B5 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B6 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long=t1.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B7 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c=cast(t1.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B8 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B9 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM t1,
     test_unnest t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B10 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long=t1.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 |   |
+-------+--------+---+
(15 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B11 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t2 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       c
FROM test_unnest t1,
     t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c=cast(t1.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
+-------+--------+---+
(6 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B16 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B17 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c1=cast(t2.c_long AS char);
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B18 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c2;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B19 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       c1
FROM test_unnest t1,
     unnest(mv_to_array(t1.c_mv_num_with_null_and_empty_val)) AS u1(c1),
     test_unnest,
     unnest(mv_to_array(t2.c_mv_num_with_null_and_empty_val)) t2 AS u2(c2)
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c1=t2.c2;
QueryInterruptedException
!error

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B20 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B21 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B22 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B23 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B24 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B25 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B26 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B27 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,

  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c)) t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B28 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c_long=t2.c_long;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
+-------+--------+---+
(75 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B29 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=cast(t2.c_long AS char);
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B30 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND cast(t1.c_long AS char)=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
+-------+--------+---+
(30 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_join TEST_ID: A7_B31 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
WITH t1 AS
  (SELECT *
   FROM test_unnest,
        unnest(mv_to_array(c_mv_num_with_null_and_empty_val)) AS u(c))
SELECT t1.c_str,
       t1.c_long,
       t1.c
FROM t1,
     t1 t2
WHERE t1.c_long IN (0,
                    1,
                    2,
                    999)
  AND t2.c_long IN (0,
                    1,
                    2,
                    999)
  AND t1.c=t2.c;
+-------+--------+---+
| c_str | c_long | c |
+-------+--------+---+
|       |      1 |   |
|       |      1 |   |
|       |      1 |   |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 1 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 2 |
|       |      1 | 3 |
|       |      1 | 3 |
|       |      1 | 3 |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 |   |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 1 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 2 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
| str2  |      2 | 3 |
|       |      0 |   |
|       |      0 |   |
|       |      0 |   |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 1 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 2 |
|       |      0 | 3 |
|       |      0 | 3 |
|       |      0 | 3 |
+-------+--------+---+
(36 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 192 Positive tests: 143 Negative tests: 49
#-------------------------------------------------------------------------

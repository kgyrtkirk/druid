!set dartQueryId 00000000-0000-0000-0000-000000000000
!set useApproximateCountDistinct false
!use druidtest://?componentSupplier=AllDruidEnginesComponentSupplier&datasets=sql/src/test/quidem/qatests/kttm_nested
!set outputformat mysql
SELECT count(*) cnt
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22');
+-----+
| cnt |
+-----+
| 768 |
+-----+
(1 row)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B1_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(*) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 3 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 5 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 4 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 6 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B2_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 8 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 8 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B3_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       count(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
not supported
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B4_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       sum(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B5_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       min(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B6_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       max(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B7_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       round(avg(mod(length(timezone), 3)) OVER w, 2) AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+-----+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c   |
+--------------+---------------+----------+---------------------+--------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0.0 |
+--------------+---------------+----------+---------------------+--------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B8_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 1 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 1 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B9_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       approx_count_distinct_builtin(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 2 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 2 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B20_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       earliest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B21_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       earliest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | EDT |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B24_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       latest_by(mod(length(timezone), 3), time_floor(__time, 'PT12H')) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B25_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       latest_by(timezone, time_floor(__time, 'PT12H'), 100) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+-----+
| server_ip    | client_ip     | timezone | t                   | c   |
+--------------+---------------+----------+---------------------+-----+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | EDT |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | N/A |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | N/A |
+--------------+---------------+----------+---------------------+-----+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B28_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       grouping(timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
+--------------+---------------+----------+---------------------+---+
| server_ip    | client_ip     | timezone | t                   | c |
+--------------+---------------+----------+---------------------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 | 0 |
+--------------+---------------+----------+---------------------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B30_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_agg(DISTINCT timezone) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B32_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       array_concat_agg(DISTINCT ARRAY['N/A', timezone], 10000) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B34_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       string_agg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W1_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W1_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W2_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W2_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (
                                                  ORDER BY server_ip,
                                                           timezone);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W3_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W3_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS (PARTITION BY client_ip);
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W4_G1_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B36_W4_G2_Q2 TYPE: NEGATIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       listagg(DISTINCT timezone, '|') OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H') WINDOW w AS ();
DISTINCT is not supported for window functions
!error

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B37_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_and(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B38_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_or(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W1_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W1_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W2_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W2_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (
                                               ORDER BY server_ip,
                                                        timezone);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W3_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W3_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS (PARTITION BY client_ip);
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G1_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM
  (SELECT server_ip,
          client_ip,
          timezone,
          time_floor(__time, 'PT12H') __time,
          mod(length(timezone), 3) v2
   FROM kttm_nested
   GROUP BY server_ip,
            client_ip,
            timezone,
            time_floor(__time, 'PT12H'),
            mod(length(timezone), 3))
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22') WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# TESTCASE: test_basics_test_agg_funcs TEST_ID: A1_B39_W4_G2_Q2 TYPE: POSITIVE TEST
#-------------------------------------------------------------------------
SELECT server_ip,
       client_ip,
       timezone,
       cast(time_floor(__time, 'PT12H') AS char) t,
       mod(length(timezone), 3),
       bit_xor(mod(length(timezone), 3)) OVER w AS c
FROM kttm_nested
WHERE client_ip IN ('107.13.54.103',
                    '99.9.55.22')
GROUP BY server_ip,
         client_ip,
         timezone,
         time_floor(__time, 'PT12H'),
         mod(length(timezone), 3) WINDOW w AS ();
+--------------+---------------+----------+---------------------+--------+---+
| server_ip    | client_ip     | timezone | t                   | EXPR$4 | c |
+--------------+---------------+----------+---------------------+--------+---+
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.11.5  | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 00:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | EDT      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 107.13.54.103 | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
| 172.31.57.89 | 99.9.55.22    | N/A      | 2019-08-25 12:00:00 |      0 | 0 |
+--------------+---------------+----------+---------------------+--------+---+
(8 rows)

!ok

#-------------------------------------------------------------------------
# Total query count 329 Positive tests: 265 Negative tests: 64
#-------------------------------------------------------------------------
